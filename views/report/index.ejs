
<div class="panel panel-success" data-bind="with: ReportsVM">
    <div class="panel-heading">
        <div class="panel-title">
            <h2><strong>PDF 報告</strong></h2>
        </div>
    </div>
    <div class="panel-body">
        <h4>Activity Report</h4>
        <div class="row">
            <div class="col-sm-4 col-md-3 form-group">
                <label for="arStartDate">Start Date</label>
                <input type="date" class="form-control" id="arStartDate" data-bind="value: ar_start_date">
            </div>
            <div class="col-sm-4 col-md-3 form-group">
                <label for="arEndDate">End Date</label>
                <input type="date" class="form-control" id="arEndDate" data-bind="value: ar_end_date">
            </div>
            <div class="col-sm-4 col-md-3 form-group">
                <div data-bind="visible: show_working">
                    <i class="fa fa-2x fa-cog fa-spin"></i>
                    <span class="h3">Updating PDF</span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-4 col-md-3">
                <h4><strong>台茂分公司:</strong></h4>
                <div class="radio">
                    <label>
                        <input type="radio" name="optionsRadios"
                               value="台茂化工儀器原料行"
                               data-bind="checked: taimao">
                        台茂化工儀器原料行
                    </label>
                </div>
                <div class="radio">
                    <label>
                        <input type="radio" name="optionsRadios"
                               value="富茂工業原料行"
                               data-bind="checked: taimao">
                        富茂工業原料行
                    </label>
                </div>
                <div class="radio">
                    <label>
                        <input type="radio" name="optionsRadios"
                               value="永茂企業行"
                               data-bind="checked: taimao">
                        泳帽化工永茂企業行
                    </label>
                </div>
            </div>
        </div>
        <iframe id="preview-pane" type="application/pdf"
                width="100%" height="500" frameborder="0"
                style="position:relative;z-index:999">
        </iframe>
<!--        <button class="btn btn-success" data-bind="disable: !ar_start_date() || ! ar_end_date(), click: ar_create">創造報告</button>-->

    </div>
    <div class="panel-footer lightorange-blend text-center">


    </div>
</div>
<script>
    var viewModel = viewModel || {};

    function ReportsVM() {
        var self = this;

        self.show_working = ko.observable(false);
        self.taimao = ko.observable('台茂化工儀器原料行');

        //TODO: (Pre)Load data when dates are set and display result
        //TODO: Enable download button when loading is complete.
        //EMBED HELP: http://stackoverflow.com/a/14958357/1172891
        self.ar_start_date = ko.observable();
        self.ar_end_date = ko.observable();
        self.shipmentsItems = [];

        ko.computed(function () {
            if (self.ar_start_date() && self.ar_end_date()) {
                self.show_working(true);
                params = {
                    _csrf: '<%= _csrf %>',
                    id: '<%= cogroup.name %>',
                    startDate: self.ar_start_date(),
                    endDate: self.ar_end_date(),
                };
                post('/database/get/activityreport', params, function(response) {
                    console.log(response);
                    self.shipmentsItems = [];
                    for (var i=0; i<response.length; i++) {
                        self.shipmentsItems.push(new KO_ShipmentListRow(response[i]));
                    }

                    console.log(self.shipmentsItems.length);
                    self.create_activity_report_pdf();
                });
            }
        });

        /**
         * Creates PDF once data is loaded or when options change
         * but not date changes (that needs to load data separately).
         */
        self.create_activity_report_pdf = function () {
            self.show_working(true);
            self.taimao();  // Listen for option change
            if (self.ar_start_date.peek() && self.ar_end_date.peek()) {
                var doc = new jsPDF();
                doc.setFont('Times', 'Roman');

                // Display a light grey grid for designing layout
                if (false) {
                    doc.setDrawColor(200);
                    doc.setTextColor(200,200,200);
                    for (var i=0; i<50; i++) {
                        doc.rect(0,i*10,300,10);
                        doc.text(0,i*10, (i*10).toString());
                        doc.rect(i*10,0,10,300);
                        doc.text(i*10,5, (i*10).toString());
                    }
                    doc.setDrawColor(0);
                    doc.setTextColor(0,0,0);
                }


                /**
                 * Settings required for doc.alttext function.
                 * Set background and foreground colors and default font size.
                 */
                doc.chsetup = {
                    background: "#fff",
                    foreground: "#000",
                    fontsize: 10
                };
                /**
                 * Prints a line of non-ASCII text as a series of images.
                 * @param {Number} x         Horizontal displacement
                 * @param {Number} y         Vertical displacement
                 * @param {String} ch_string Non-ASCII string to add as an image
                 * @param {Number} fontsize  Similar sizing as doc.setFontSize()
                 */
                doc.alttext = function nonASCIIDecorator(x, y, ch_string, fontsize) {
                    // Test if there is non-ASCII characters in string
                    if (ch_string === null) return;
                    var nonASCII = false;
                    for (var i=0; i<ch_string.length; i++) {
                        if (ch_string.charCodeAt(i) > 128) {
                            nonASCII = true;
                        }
                    }
                    // If all ASCII then use doc.text function and exit
                    if (nonASCII === false) {
                        doc.setFontSize(fontsize);
                        doc.text(x, y, ch_string);
                        return;
                    }
                    // Setup canvas if first time and settings
                    if (doc.chsetup.ctx === undefined) {
                        doc.chsetup.canvas = document.createElement('canvas');
                        doc.chsetup.canvas.width = '150';  // Height default is 150
                        doc.chsetup.ctx = doc.chsetup.canvas.getContext('2d');
                        doc.chsetup.ctx.font = "bold 150px PMingLiU";
                    }
                    var ctx = doc.chsetup.ctx,
                        char = null,
                        xi = x,
                        size = 150,
                        scale = (fontsize || doc.chsetup.fontsize) / 450;
                    // Make image for each character and add to document
                    for (var i=0; i<ch_string.length; i++) {
                        ctx.fillStyle = doc.chsetup.background;
                        ctx.fillRect(0,0,size,size);  // Clear content
                        ctx.fillStyle = doc.chsetup.foreground;
                        ctx.fillText(ch_string.charAt(i), 0, 120);  // Draw character
                        char = doc.chsetup.canvas.toDataURL("image/jpeg", 1.0);  // 1.0 highest quality
                        doc.addImage(char, 'JPEG', xi, y-size*scale*.9, size*scale, size*scale);
                        xi = xi + ctx.measureText(ch_string.charAt(i)).width*scale*1.1;  // 1.1 for a little extra space
                    }
                };

                // HEADER Section
                var logoURI = "data:image/jpeg;base64,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AAAAUmQgIGRvdWJAb+AAAAAAAAAAAABHcm4gZG91YkBv4AAAAAAAAAAAAEJsICBkb3ViQG/gAAAAAAAAAAAAQnJkVFVudEYjUmx0AAAAAAAAAAAAAAAAQmxkIFVudEYjUmx0AAAAAAAAAAAAAAAAUnNsdFVudEYjUHhsQHLAAAAAAAAAAAAKdmVjdG9yRGF0YWJvb2wBAAAAAFBnUHNlbnVtAAAAAFBnUHMAAAAAUGdQQwAAAABMZWZ0VW50RiNSbHQAAAAAAAAAAAAAAABUb3AgVW50RiNSbHQAAAAAAAAAAAAAAABTY2wgVW50RiNQcmNAWQAAAAAAAAAAABBjcm9wV2hlblByaW50aW5nYm9vbAAAAAAOY3JvcFJlY3RCb3R0b21sb25nAAAAAAAAAAxjcm9wUmVjdExlZnRsb25nAAAAAAAAAA1jcm9wUmVjdFJpZ2h0bG9uZwAAAAAAAAALY3JvcFJlY3RUb3Bsb25nAAAAAAA4QklNA+0AAAAAABABLAAAAAEAAQEsAAAAAQABOEJJTQQmAAAAAAAOAAAAAAAAAAAAAD+AAAA4QklNBA0AAAAAAAQAAAAeOEJJTQQZAAAAAAAEAAAAHjhCSU0D8wAAAAAACQAAAAAAAAAAAQA4QklNJxAAAAAAAAoAAQAAAAAAAAABOEJJTQP1AAAAAABIAC9mZgABAGxmZgAGAAAAAAABAC9mZgABAKGZmgAGAAAAAAABADIAAAABAFoAAAAGAAAAAAABADUAAAABAC0AAAAGAAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0EAAAAAAAAAgAAOEJJTQQCAAAAAAACAAA4QklNBDAAAAAAAAEBADhCSU0ELQAAAAAABgABAAAAAzhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAAM9AAAABgAAAAAAAAAAAAAAOwAAAJMAAAAEAGwAbwBnAG8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAJMAAAA7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Yzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzdhYTZmZjYtN2Y5Zi1jMjQ4LTkyYzYtYmI5NGE3OWJiM2I4IiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6NDg0NjU0MjktMjllOC0xMWU1LTk3YzMtODcyZGUwNmQzZjFjIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZTM0M2I3ZmYtZDA1YS01NTRkLWE0YjAtODYzZTEyMWQ1OWZhIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplMzQzYjdmZi1kMDVhLTU1NGQtYTRiMC04NjNlMTIxZDU5ZmEiIHN0RXZ0OndoZW49IjIwMTUtMDEtMTdUMDg6NDU6MjkrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE0IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGltYWdlL3BuZyB0byBpbWFnZS9qcGVnIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3N2FhNmZmNi03ZjlmLWMyNDgtOTJjNi1iYjk0YTc5YmIzYjgiIHN0RXZ0OndoZW49IjIwMTUtMDctMTRUMTM6MjM6NDErMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE0IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg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";
                var scale = 0.22;
                doc.addImage(logoURI, 'JPEG', 25, 5, 147*scale, 59*scale);
                doc.setFontSize(14);
                doc.alttext(100, 15, '客戶名稱: <%= cogroup.name %>', 14);
                doc.alttext(100, 20, '日期:', 14);
                doc.text(113, 20, self.ar_start_date.peek() + ' ~ ' + self.ar_end_date.peek());
                doc.alttext(27, 22, self.taimao(), 12);

                doc.setFillColor(100);
                doc.rect(10, 25, 190, 1, 'F');

                // Table header
                var headers = ['日期','出貨單號','品名','數量','單位','包裝','單價','總價','發票號碼'];
                var spacing = [ 14,    40,      60,   100,  114,   125,  140,  160,   180];


                for (var i=0; i<headers.length; i++) {
                    doc.alttext(spacing[i], 30, headers[i], 11);
                }
                doc.rect(10, 31, 190, 0.2, 'F');

                for (var j=0; j<self.shipmentsItems.length; j++) {
                    doc.alttext(spacing[0], 40+j*5, self.shipmentsItems[j]['shipmentdate'].toISOString().substring(0,10), 11);
                    doc.alttext(spacing[1], 40+j*5, self.shipmentsItems[j]['shipment_no'], 11);
                    doc.alttext(spacing[2], 40+j*5, self.shipmentsItems[j]['product_label'], 11);
                    doc.alttext(spacing[3], 40+j*5, self.shipmentsItems[j]['qty'].toString(), 11);
                    doc.alttext(spacing[4], 40+j*5, self.shipmentsItems[j]['UM'], 11);
                    doc.alttext(spacing[5], 40+j*5, self.shipmentsItems[j]['SKU'], 11);
                    doc.alttext(spacing[6], 40+j*5, self.shipmentsItems[j]['price'].toString(), 11);
                    doc.alttext(spacing[7], 40+j*5, self.shipmentsItems[j]['value'].toString(), 11);
                    doc.alttext(spacing[8], 40+j*5, self.shipmentsItems[j]['invoice_no'], 11);
                }
                doc.save('asdf.pdf');
//                var pp = document.getElementById('preview-pane');
//                pp.src = doc.output('datauristring');
            }
            self.show_working(false);
        };
    }

    viewModel.ReportsVM = new ReportsVM();
</script>
